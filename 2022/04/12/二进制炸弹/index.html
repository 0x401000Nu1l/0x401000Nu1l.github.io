<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="你越安静,你能听到的就越多" href="https://0x401000nu1l.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="你越安静,你能听到的就越多" href="https://0x401000nu1l.github.io/atom.xml"><link rel="alternate" type="application/json" title="你越安静,你能听到的就越多" href="https://0x401000nu1l.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="CSAPP_LAB"><link rel="canonical" href="https://0x401000nu1l.github.io/2022/04/12/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%82%B8%E5%BC%B9/"><title>二进制炸弹 | 那我就让时光倒流 = 你越安静,你能听到的就越多</title><meta name="generator" content="Hexo 6.1.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">二进制炸弹</h1><div class="meta"><span class="item" title="Created: 2022-04-12 09:40:12"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2022-04-12T09:40:12+08:00">2022-04-12</time> </span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">Symbols count in article</span> <span>11k</span> <span class="text">words</span> </span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">Reading time</span> <span>10 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">那我就让时光倒流</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipex2cdtbj20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclxp31goj20zk0m8qv5.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipexw3o58j20zk0m8e81.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicitspjpbj20zk0m81ky.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipevgoki5j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipewf5l51j20zk0m8b29.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="https://0x401000nu1l.github.io/2022/04/12/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%82%B8%E5%BC%B9/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="那我就让时光倒流"><meta itemprop="description" content=", (σﾟ∀ﾟ)σ..:*☆哎哟不错哦"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="你越安静,你能听到的就越多"></span><div class="body md" itemprop="articleBody"><h1 id="哈尔滨工业大学计算机系统lab2"><a class="anchor" href="#哈尔滨工业大学计算机系统lab2">#</a> <strong>哈尔滨工业大学计算机系统 LAB2</strong></h1><h3 id="一实验基本信息"><a class="anchor" href="#一实验基本信息">#</a> 一，实验基本信息</h3><h4 id="1实验目的"><a class="anchor" href="#1实验目的">#</a> 1. 实验目的</h4><p>​	拆炸弹，了解汇编 and <strong>fun</strong></p><h4 id="2实验环境与工具"><a class="anchor" href="#2实验环境与工具">#</a> 2. 实验环境与工具</h4><h5 id="21硬件环境"><a class="anchor" href="#21硬件环境">#</a> 2.1 硬件环境</h5><p>​	Intel i7-i0875H 64 位处理器 RTX2070</p><h5 id="22软件环境"><a class="anchor" href="#22软件环境">#</a> 2.2 软件环境</h5><p>​	Windows<strong>11</strong> &amp; Ubuntu 20.04 64 位</p><h5 id="23-开发工具"><a class="anchor" href="#23-开发工具">#</a> 2.3 开发工具</h5><p>​	vscode IDA pro gdb(peda)</p><h3 id="二各阶段炸弹的破解与分析"><a class="anchor" href="#二各阶段炸弹的破解与分析">#</a> 二，各阶段炸弹的破解与分析</h3><p>​</p><h4 id="1初步分析"><a class="anchor" href="#1初步分析">#</a> 1. 初步分析</h4><p>在 gdb 环境下安装 peda 或者 pwndbg 都会大大提高工作效率，工作界面友好很多</p><p>[peda &amp; pwndbg 安装](<span class="exturl" data-url="aHR0cDovL3BlY2tlcndvb2QudG9wL3Bvc3QvcGVkYV92c19wd25kYmdfZ2RiLw==">Peda vs Pwndbg - GDB - p3ck3rw00d's blog (peckerwood.top)</span>)</p><p><code>$ gdb bomb</code></p><p>首先查看函数列表</p><p><code>$ info functions</code></p><p><img data-src="image-20220409131530471.png" alt></p><p>看到常规函数可以猜想可执行文件结构，phase_* 等代表不同的关卡，explode_bomb 为炸弹引爆函数 phase_defuse 函数应该是成功拆除炸弹的提示函数，其他函数根据函数名即可知道相应的功能。</p><p>大体知道文件结构之后即可设置断点，开始动态调试</p><p><code>$ b main</code></p><h4 id="2第一关的破解与分析"><a class="anchor" href="#2第一关的破解与分析">#</a> 2. 第一关的破解与分析</h4><p>进入 main 函数之后一步步 n</p><p><img data-src="image-20220409132702810.png" alt="image-20220409132702810"></p><p>可以看出初始化炸弹的函数被调用，之后一直单步步过到 read_line 函数</p><p>提示输入</p><p><img data-src="image-20220409132945900.png" alt="image-20220409132945900"></p><p>先输入 111111，继续前进</p><p><img data-src="image-20220409133040436.png" alt="image-20220409133040436"></p><p>很明显，我们输入的 &quot;111111&quot; 被送到 rdi 寄存器然后调用函数 phase_1</p><p>使用指令 s 进入 phase_1 函数</p><p><code>$ disas #查看phase_1函数的汇编</code></p><p><img data-src="image-20220409133645790.png" alt="image-20220409133645790"></p><p>函数接受的输入存在了 rdi 寄存器中，这里又从内存中取出一段数据存入 rsi</p><p>接着调用函数 string_not_equal</p><blockquote><p>参数传入函数时，使用寄存器的顺序 寄存器 **% rdi, % rsi, % rdx, % rcx, % r8, % r9** 分别用来保存函数的 6 个参数，而 % rax 用来保存函数的返回值。</p></blockquote><p>所以第一关就是考简单的函数调用，单步步过之后查看 rsi 寄存器的值就能的到第一关的 ans</p><p><img data-src="image-20220409134213172.png" alt="image-20220409134213172"></p><p>这里就体现出了 peda 的好处，可以直接查看寄存器的值以及 rip 所指地址附近的汇编代码，可以看到我们输入的值</p><p>&quot;111111&quot;</p><p>以及正确答案</p><p>&quot;I am not part of the problem. I am a Republican.&quot;</p><h4 id="3第二关的破解与分析"><a class="anchor" href="#3第二关的破解与分析">#</a> 3. 第二关的破解与分析</h4><p>执行如下命令直接运行到 phase_2 处</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>k <span class="token comment">#中断当前调试进程</span></pre></td></tr><tr><td data-num="2"></td><td><pre>b phase_2</pre></td></tr><tr><td data-num="3"></td><td><pre>r <span class="token comment">#重新开始动态调试</span></pre></td></tr></table></figure><p>之后会提示输入第一关密码，输入后程序停止，之后开始单步调试</p><p><img data-src="image-20220409135044864.png" alt="image-20220409135044864"></p><p>我们继续输入 123456 尝试</p><p><code>$ disas # 查看phase_2的汇编代码</code></p><p><img data-src="image-20220409135456198.png" alt="image-20220409135456198"></p><p>观察下图</p><p><img data-src="image-20220409140145503.png" alt="image-20220409140145503"></p><p>可以看到 Phase_2 调用了 read_six_numbers 函数读入了 6 个数字，并且，由函数开头声明栈的操作，可以看出是通过栈来传递参数给 read_six_numbers 函数</p><p><img data-src="image-20220409141653178.png" alt="image-20220409141653178"></p><p>这里的意图很明显了，既然是通过栈传递参数，这里是检验输入的前两个值</p><p>可以知道一共需要读入六个数，其中<strong>前两个数分别为 0 1</strong> 验证前两个数成功后跳转到</p><p><img data-src="image-20220409142830866.png" alt="image-20220409142830866"></p><p>后面的这部分其实是一个<strong>循环</strong>（<em>因为之前学习汇编的时候王爽老师书里面讲的控制循环的寄存器是 cx (rcx,ecx)，所以第一时间看到代码的时候也是没反应过来是循环，但是看到 ebx 寄存器被赋初值，然后每次加一接着不断地跳回到之前的代码执行，最后还不断地将 ebx 的值与固定值 0x5 比较，才发觉应该是循环</em>）</p><p><img data-src="image-20220409143416779.png" alt="image-20220409143416779"></p><p>这段代码也很好理解， &amp;ecx=&amp;ebx-1 &amp;eax=&amp;ebx-1 接着比较 A [&amp;edx] 与 A [&amp;ecx]+A [&amp;eax] 的大小，这不就是斐波那契么 ((*･ω&lt; ) )</p><p>所以将这一关翻译成 C 语言就是</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span> numbers<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> numbers<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> numbers<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token function">explode_bomb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>解题脚本如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">int</span> nums<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>nums<span class="token operator">=</span><span class="token number">0x100000000LL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>nums<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>nums<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">//  0 1 1 2 3 5</span></pre></td></tr></table></figure><h4 id="4第三关的破解与分析"><a class="anchor" href="#4第三关的破解与分析">#</a> 4. 第三关的破解与分析</h4><p><img data-src="image-20220409145016026.png" alt="image-20220409145016026"></p><p>清除断点之后在 phase_3 下断点，接着 r 运行，输入前两关得到的密码之后程序就会停在第三关</p><p>提示输入</p><p><img data-src="image-20220409145224075.png" alt="image-20220409145224075"> 我们继续输入 &quot;123456&quot; 尝试</p><p>接着单步步过</p><p><img data-src="image-20220409152349593.png" alt="image-20220409152349593"></p><p>发现从内存中向 esi 寄存器中传入了数据，si 运行到赋值完成，查看 esi 内保存的值</p><p><img data-src="image-20220409152520489.png" alt="image-20220409152520489"></p><p>可以看到是格式化输入的字符串，由此可知后面的 scanf 函数接受的是两个整型变量</p><p>之后进入第一层判断，判断 scanf 的返回值</p><blockquote><p>我们可以通过运用函数 scanf () 的返回值的意义（即 “所输入的数据与格式字符串中匹配次数”），来把控我们的输入格式的正确性.</p></blockquote><p><img data-src="image-20220409155313942.png" alt="image-20220409155313942"></p><p>这里要求返回值 &gt; 1，之后<img data-src="image-20220409155615483.png" alt="image-20220409155615483"> 要求输入的第一个参数小于 7</p><p>完成这些前置判定之后</p><p><img data-src="image-20220409155738679.png" alt="image-20220409155738679"></p><p>该代码段中包含一段内存地址</p><p>使用 gdb 查看内存地址的命令查看所指内存地址</p><p><img data-src="image-20220409155907546.png" alt="image-20220409155907546"></p><p>由于小端序存储的原因，上面地址简化一下就是 0x4014dc~0x401506 地址值</p><p>所以可以判断这是一个跳转表</p><p><img data-src="image-20220409160048474.png" alt="image-20220409160048474"></p><p>并且通过 rax 控制跳转</p><blockquote><p>switch 语句可以根据一个整数索引值进行多重分支。</p><p>GCC 根据 case 的数量和 case 值的稀疏程度来翻译 switch 语句，当 case 情况比较多 (例如 4 个以上)，并且值的范围跨度比较小时，就会使用跳转表。</p><p>跳转表是一个数组，表项 i 是一个代码段的地址，这个代码段实现当开关索引值等于 i 时程序应该采取的动作。</p></blockquote><p>由此可以判断这关考查的是 switch 语句的汇编语言的实现</p><p><img data-src="image-20220409160237069.png" alt="image-20220409160237069"></p><p>继续回看这段代码就可以由此列出反汇编之后的 C 语言代码</p><pre><code class="language-C">void __fastcall phase_3(char *input)
&#123;
  int v1; // eax
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int sum; // [rsp+8h] [rbp-10h] BYREF
  int index; // [rsp+Ch] [rbp-Ch] BYREF

  if ( (int)__isoc99_sscanf(input, &quot;%d %d&quot;, &amp;index, &amp;sum) &lt;= 1 )
    explode_bomb();
  switch ( index )
  &#123;
    case 0:
      v1 = 799;
      goto LABEL_5;
    case 1:
      v1 = 0;
LABEL_5:
      v2 = v1 - 301;
      goto LABEL_6;
    case 2:
      v2 = 0;
LABEL_6:
      v3 = v2 + 740;
      goto LABEL_7;
    case 3:
      v3 = 0;
LABEL_7:
      v4 = v3 - 772;
      goto LABEL_8;
    case 4:
      v4 = 0;
LABEL_8:
      v5 = v4 + 772;
      goto LABEL_9;
    case 5:
      v5 = 0;
LABEL_9:
      v6 = v5 - 772;
      goto LABEL_10;
    case 6:
      v6 = 0;
LABEL_10:
      v7 = v6 + 772;
      break;
    case 7:
      v7 = 0;
      break;
    default:
      explode_bomb();
  &#125;
  v8 = v7 - 772;
  if ( index &gt; 5 || sum != v8 )
    explode_bomb();
&#125;
// from IDA pro 
</code></pre><p>很容易就可以得到答案 2 -32 (答案不唯一)</p><h4 id="5第四关的破解与分析"><a class="anchor" href="#5第四关的破解与分析">#</a> 5. 第四关的破解与分析</h4><p>和前面方法一样，下断点，然后运行到 phase_4 处，并且继续输入 &quot;123456&quot;</p><p>直接使用 disas 命令查看汇编代码</p><p><img data-src="image-20220409160906296.png" alt="image-20220409160906296"></p><p>和第三关一样，先根据 scanf 的返回值判断输入格式以及输入个数的正确性</p><p><img data-src="image-20220409162507706.png" alt="image-20220409162507706"></p><p>接着这段代码要求 eax 不能等于 0 并且 eax 小于等于 14 即 <strong>eax&gt;0&amp;&amp;eax&lt;=14</strong></p><p><img data-src="image-20220409162720472.png" alt="image-20220409162720472"></p><p>后面这一段也很好理解，就是将 scanf 输入的第一个参数传给 edi 寄存器并且将 esi 寄存器值赋为 0，调用<strong> fun4</strong> 之后的结果再与 0x5 比较，由此可知<strong> fun 返回值应该为 5</strong></p><p>由于上面知道了需要输入的是两个整形数，所以重新开始调试，并且输入 &quot;1 2&quot;</p><p>成功通过第一道判断</p><p><img data-src="image-20220409164845944.png" alt="image-20220409164845944"></p><p>接着一直 si 并进入 fun4，查看 fun4 的汇编代码</p><p><img data-src="image-20220409165225541.png" alt="image-20220409165225541"></p><p>一步步向下分析直到代码</p><p><code>shr eax,0x1f</code></p><p>关于这段代码，特别感谢我的两位同学指出我的错误 @ywy_c_asm &amp; @cnwangjihe</p><blockquote><p><strong>那一段是用来处理负数整除问题的</strong><br><strong>他下方的 sar 是带符号位的右移</strong><br><strong>- 15 右移一位结果是 - 8，但 c 里面整除二结果应该是 - 7，所以需要额外加一</strong><br><strong>正数右移一位和整除二则是等价的 \ <em>from @cnwangjihe</em></strong></p><p><strong>带符号右移永远等价于除二向下取整，<em>然后再用符号位调整一下</em> from @ywy_c_asm</strong></p></blockquote><p><img data-src="image-20220409170638377.png" alt="image-20220409170638377"></p><p>这段代码结合调用 fun4 函数之前的代码一起分析就能知道 eax 等于 fun4 接收的参数 esi 与 ecx 的平均数 即 <strong>&amp;eax = &amp;esi+(&amp;ecx-&amp;esi)/2</strong></p><p>最后将 eax 再与 edi 相比较，根据比较结果再次跳转，并且再次调用 fun4</p><p>由此可知，这一关考查的是<strong>递归函数</strong>的汇编语言实现</p><p>并且由汇编可以轻松分析 C 语言函数</p><pre><code class="language-C">int __fastcall func4(int val, int low, int high)
&#123;
  int v3; // eax

  v3 = low + (high - low) / 2;
  if ( v3 &gt; val )
    return 2 * func4(val, low, v3 - 1);
  if ( v3 &lt; val )
    return 2 * func4(val, v3 + 1, high) + 1;
  return 0;
&#125;
//from IDA pro
</code></pre><p>解决 fun4 的问题就可以得出当时 scanf 接收的第一个输入值的正确值，还有第二个输入值的值未确定，继续看跳出递归之后的代码段</p><p><img data-src="image-20220409171624641.png" alt="image-20220409171624641"></p><p>至此，两个参数的值都能确定</p><p>解题脚本如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> <span class="token function">fun4</span><span class="token punctuation">(</span><span class="token keyword">int</span> uv<span class="token punctuation">,</span><span class="token keyword">int</span> low<span class="token punctuation">,</span><span class="token keyword">int</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">int</span> uv<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">int</span> sum<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span> uv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>uv<span class="token operator">&lt;=</span><span class="token number">14</span><span class="token punctuation">;</span>uv<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        sum<span class="token operator">=</span><span class="token function">fun4</span><span class="token punctuation">(</span>uv<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>sum<span class="token operator">==</span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>uv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">int</span> <span class="token function">fun4</span><span class="token punctuation">(</span><span class="token keyword">int</span> uv<span class="token punctuation">,</span><span class="token keyword">int</span> low<span class="token punctuation">,</span><span class="token keyword">int</span> high<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">int</span> v3<span class="token operator">=</span>low<span class="token operator">+</span><span class="token punctuation">(</span>high<span class="token operator">-</span>low<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>v3<span class="token operator">></span>uv<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">fun4</span><span class="token punctuation">(</span>uv<span class="token punctuation">,</span>low<span class="token punctuation">,</span>v3<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>v3<span class="token operator">&lt;</span>uv<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">fun4</span><span class="token punctuation">(</span>uv<span class="token punctuation">,</span>v3<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>high<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">// output 10</span></pre></td></tr></table></figure><h4 id="6第五关的破解与分析"><a class="anchor" href="#6第五关的破解与分析">#</a> 6. 第五关的破解与分析</h4><p>同前几关的方式，在 phase_5 处打断点，然后运行到 phase_5, 接着继续输入 &quot;123456&quot; 测试，单步步过到达 phase_5, 继续 disas 查看汇编代码</p><p><img data-src="image-20220409190043150.png" alt="image-20220409190043150"></p><p>前面的代码都很熟悉，0x40334f 处的数据正是第四关里的 &quot;% d % d&quot;, 根据提示重新输入测试值 &quot;1 2&quot;</p><p><img data-src="image-20220409191812554.png" alt="image-20220409191812554"></p><p>该段代码对参数做了一些运算 ，函数通过栈来传递参数，并且传参顺序与 C 语言中参数顺序刚好相反，所以这里 [rsp+0xc] 即为第一个参数，记为 val1，也就是我们输入的 1 ，[rsp+0x8] 即为第二个参数记为 val2，也就是我们输入的 2。</p><p>接着，程序又定义了两个变量 (寄存器)，ecx=0,edx=0, 分别记作 v3,v4</p><p>所以这段汇编代码翻译为 C 代码即为</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>val1 <span class="token operator">&amp;=</span> <span class="token number">0xf</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="2"></td><td><pre>v3 <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//ecx</span></pre></td></tr><tr><td data-num="3"></td><td><pre>v4 <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//edx</span></pre></td></tr></table></figure><p><img data-src="image-20220409192718574.png" alt="image-20220409192718574"></p><p>这段代码其实已经很好理解了，考点就是数组的汇编语言实现</p><p>查看 0x403200 处的数据</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>x/100xb 0x403200</pre></td></tr></table></figure><p><img data-src="image-20220409193548299.png" alt="image-20220409193548299"></p><p>能够看出来是数组，既然是数组，就可以用另一种方法提取数组 (之前搞逆向的时候，用 IDA PRO 可以直接快捷键 shift+e 就能提取数组，但是 gdb 只能以一种很原始的方式)</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>p *array@length <span class="token comment">#array 可以是数组名也可以是内存地址，length 指的是想要查看的位数</span></pre></td></tr></table></figure><p><img data-src="image-20220409194307752.png" alt="image-20220409194307752"></p><p>后面的乱码及说明不是数组内容，取前面的即可。</p><p>翻译成 C 代码即是</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span>val1<span class="token operator">!=</span><span class="token number">0xf</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    v4<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    val1<span class="token operator">=</span>array<span class="token punctuation">[</span>val1<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    v3<span class="token operator">+=</span>val1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">//array[]=&#123;0xa, 0x2, 0xe, 0x7, 0x8, 0xc, 0xf, 0xb, 0x0, 0x4, 0x1, 0xd, 0x3, 0x9, 0x6, 0x5&#125;</span></pre></td></tr></table></figure><p>循环结束之后到达</p><p><img data-src="image-20220409194636150.png" alt="image-20220409194636150"></p><p>这里比较了 val2 与 v3 的大小关系，并且要求 val2 与 v3 大小相等</p><p>据此可以写出解题脚本</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">int</span> p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">15</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        p<span class="token operator">=</span>i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        p <span class="token operator">&amp;=</span><span class="token number">15u</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">int</span> v2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">int</span> v1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">while</span><span class="token punctuation">(</span>p<span class="token operator">!=</span><span class="token number">15</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token operator">++</span>v2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            p<span class="token operator">=</span>arr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            v1<span class="token operator">+=</span>p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>v2<span class="token operator">==</span><span class="token number">15</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"searched i=%d v1=%d"</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">// 直接爆破 (～￣▽￣)～</span></pre></td></tr></table></figure><p>得出答案</p><h4 id="7第六关的破解与分析"><a class="anchor" href="#7第六关的破解与分析">#</a> 7. 第六关的破解与分析</h4><p>个人感觉 objdump 的界面不是很友好，比较乱，更不如 gdb-peda 用起来方便，所以继续使用 gdb (其实使用 IDApro 会简单很多，但是为了检验一下自己的汇编基本功，就还是嗯看汇编代码吧)</p><p>老方法，在 Phase_6 处<strong>下断点</strong>，然后<strong> run</strong> 到 Phase 后使用<strong> disas</strong> 命令查看汇编</p><p><strong>个人经验</strong> ：寄存器在每个独立的代码段中充当的更多的是局部变量，汇编语言通过对寄存器的完美使用来实现不同的功能</p><p>既然寄存器大多扮演局部变量，所以为了方便分析，给每个寄存器都设一个特定的变量名，如下</p><p><em><strong>r12 == j rbp == i rbx== n rax == p rcx == m rdx == v1 rdi ==v2</strong></em></p><p>这里暂时不知道各个变量的类型，等到后面分析就会一一确定</p><p><img data-src="image-20220411133452259.png" alt="image-20220411133452259"></p><p>这段代码的作用是定义变量同时建立堆栈，然后给 rsi 赋值之后作为参数送入函数 read_six_numbers, 查看 read_six_numbers 函数的汇编代码</p><p><img data-src="image-20220411134848160.png" alt="image-20220411134848160"></p><blockquote><p><em><strong>LEA 与 MOV 的区别</strong></em></p><p>lea 是 “load effective address” 的缩写，简单的说，<strong>lea 指令可以用来将一个内存地址直接赋给目的操作数</strong>，例如：</p><p><strong>lea eax,[ebx+8] 就是将 ebx+8 这个值直接赋给 eax，而不是把 ebx+8 处的内存地址里的数据赋给 eax</strong>。</p><p>而 mov 指令则恰恰相反，例如：</p><p>mov eax,[ebx+8]</p><p>则是把内存地址为 ebx+8 处的数据赋给 eax。</p></blockquote><p>所以调用 read_six_numbers 函数之前</p><p><img data-src="image-20220411135218612.png" alt="image-20220411135218612"></p><p>这里的 lea rsi,[rsp+0x30] 的目的就是将 rsp+0x30 这段地址直接赋值给 rsi，而不是将 rsp+0x30 处的值传给 rsi。</p><p>接着进入 read_six_numbers 后</p><p><img data-src="image-20220411135612002.png" alt="image-20220411135612002"></p><p>这里我原本以为的是获取六个输入变量的地址，然后将地址传入 scanf 函数直接读入，但是分析这一段是发现了问题，这里<strong>首先是通过 rax 寄存器向栈中压入了两个值，然后在调用 scanf 读值</strong>，根据前面几关中的经验，scanf 函数的参数首先是读入值的格式化字符串也就是前几关常见的类似 &quot;% d % d&quot; 这种，在 read_six_numbers 函数中 0x403343 地址处的值扮演了这个角色，查看该处的数据值</p><p><img data-src="image-20220411141238206.png" alt="image-20220411141238206"></p><p>果然是读入了六个整数，所以 scanf 函数一共接受了 7 个参数</p><blockquote><p>当参数个数小于等于 6 个时，使用寄存器<strong> rdi,rsi,rdx,rcx,r8,r9，从第 7 个参数开始通过栈传递，顺序为从右往左入栈</strong></p></blockquote><p>这样就可以解释的通为什么 read_six_numbers 会选择先将值先入栈，再调用 scanf</p><p>读完之后继续分析 phase_6</p><p><img data-src="image-20220411144854347.png" alt="image-20220411144854347"></p><p>汇编语言写的循环结构都有很强的套路性，通常都用一个固定的寄存器表示一个循环变量，然后也包含循环结束标志，还有每次循环循环变量如何发生改变 (也就是 for 循环括号里的内容) 据此，我们可以很容易的确定循环部分</p><p>如上图，我们可以发现外围循环是以 ebp 为循环变量的循环，内嵌了以 ebx 为循环变量的循环</p><p><img data-src="image-20220411151332183.png" alt="image-20220411151332183"></p><p>分析循环结构的时候如果遇到跳出循环的语句，可以做标记然后不跳出，继续执行后面的代码，并且很有可能后面的代码就是循环执行的部分，就像上图中的一样</p><p>分析后很简单就能写出 C 代码</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">//rbp</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token comment">// rbx</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">int</span> p<span class="token punctuation">;</span> <span class="token comment">//rax</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//[rsp+0x30] ~</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token function">bomb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span>n<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>n<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>n<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">==</span>arrat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token function">bomb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">/* tips: dword ptr [] 是整型数值</span></pre></td></tr><tr><td data-num="16"></td><td><pre>		qword ptr [] 是一个指针</pre></td></tr><tr><td data-num="17"></td><td><pre>*/</pre></td></tr></table></figure><p>再往下看</p><p><img data-src="image-20220411154357498.png" alt="image-20220411154357498"></p><p>这段也是很明显的循环结构，直接翻译成 C 代码如下</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> p<span class="token punctuation">;</span> <span class="token comment">//rax</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>p<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>p<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    array<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">7</span><span class="token operator">-</span>array<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>后面也是一样的分析方法</p><p><img data-src="image-20220411160543274.png" alt="image-20220411160543274"></p><p>这里要注意的是之前的 array [] 数组地址是 [rsp+0x30]</p><p>但是这里出现了一个新的地址，[rsp]，这是 phase_6 自己的数组，起名为 newarr [6]</p><p>还有一个点需要注意</p><p><img data-src="image-20220411160819721.png" alt><img data-src="image-20220411160835458.png" alt="image-20220411160835458"></p><p>这两者<strong>相同点是 DWORD PTR, 说明两者都是指针变量</strong>，不同点是前者 [rsp+rdx * 8] [ ] 里面有 rdx 寄存器，也就是说<strong> rdx (寄存器) 做索引</strong>，所以这里的 [rsp+rdx*8] 其实就是数组的地址，而 rdx 也就是数组的索引</p><p>后者没有索引，而且其实寄存器是 rcx 而不是栈顶指针 rsp</p><p>通常用这种形式表示链表 <strong>链表的 next 指针刚好占 8 个字节</strong> (实验环境为 64 位).</p><blockquote><p>一个指针在 32 位的计算机上，占 4 个字节；<br>一个指针在 64 位的计算机上，占 8 个字节。</p></blockquote><p>所以这里的 [rcx+0x8] 就相当于 rcx=rcx-&gt;next</p><p>说到这里，后文中出现的</p><p><img data-src="image-20220411161738385.png" alt="image-20220411161738385"><img data-src="image-20220411161752473.png" alt="image-20220411161752473"></p><p>这两者都是<strong> DWORD PTR , 说明两者都是整型数据</strong>，所以这里的 **[rbx] 就是 node-&gt;value**</p><p>而 **[rbx+0x8] 就是 node-&gt;next-&gt;value**</p><p>这样的话就可以根据汇编写出来 C 代码</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">//rsi</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> p<span class="token punctuation">;</span> <span class="token comment">//rax</span></pre></td></tr><tr><td data-num="3"></td><td><pre>listnode<span class="token operator">*</span> v1<span class="token punctuation">;</span><span class="token comment">//rdx</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>v3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>v3<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>v3<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    v1 <span class="token operator">=</span> node<span class="token punctuation">;</span> <span class="token comment">// 指向 0x4052d0</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span>v3<span class="token punctuation">]</span><span class="token operator">></span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        v1<span class="token operator">=</span>v1<span class="token operator">-></span>next<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token operator">++</span>p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    newarr<span class="token punctuation">[</span>v3<span class="token punctuation">]</span><span class="token operator">=</span>v1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><img data-src="image-20220411163341554.png" alt="image-20220411163341554"></p><p><img data-src="C:%5CUsers%5CIkhan%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220411164911168.png" alt="image-20220411164911168"></p><p>认准循环变量，然后找跳转条件，就能很容易的分析出来这段代码</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>listnode<span class="token operator">*</span> n <span class="token operator">=</span> newarr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// rbx</span></pre></td></tr><tr><td data-num="2"></td><td><pre>listnode<span class="token operator">*</span> m <span class="token operator">=</span> newarr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//rcx</span></pre></td></tr><tr><td data-num="3"></td><td><pre>listnode<span class="token operator">*</span> v1 <span class="token punctuation">;</span> <span class="token comment">// rdx </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> p<span class="token punctuation">;</span> <span class="token comment">//rax</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">//rbp</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>p<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>p<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    v1<span class="token operator">=</span>newarr<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    m<span class="token operator">-></span>next <span class="token operator">=</span> v1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    m<span class="token operator">=</span>v1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>m<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">-></span>value <span class="token operator">&lt;</span>n<span class="token operator">-></span>next<span class="token operator">-></span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token function">bomb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    n<span class="token operator">=</span>n<span class="token operator">-></span>next<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>函数结构分析出来后，就知道这一关考查的是链表的汇编语言实现，我们接着查看链表的结构</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>x/100xb 0x4052d0</pre></td></tr></table></figure><p>结果如下</p><p><img data-src="image-20220411171156760.png" alt="image-20220411171156760"></p><p>果然是链表，&lt;nodex&gt; 是 &quot;value&quot; &lt; nodex+8 &gt; 是 &quot;next&quot;.</p><p>自己动手写链表虽然简单但是总归有点麻烦，直接用 IDA PRO</p><p>选中链表节点之后 使用快捷键 <strong>shift+e</strong> 提取</p><p><img data-src="image-20220411171627129.png" alt="image-20220411171627129"></p><p>将分析的得到的 C 语言代码进一步分析就能知道，用户输入的数组 arr [6] 经过计算之后使链表元素按 value 值的降序排列</p><p>上一步又得到了不同节点的 value 值，所以人工排序就能得到处理之后的 arr [6]，又因为之前</p><p><img data-src="C:%5CUsers%5CIkhan%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220411211412617.png" alt="image-20220411211412617"></p><p>所以就可以逆向得到用户要输入的正确的数组</p><p>所有的答案就在这里了。</p><blockquote><p>I am not part of the problem. I am a Republican.<br>0 1 1 2 3 5<br>2 -32 (答案不唯一)<br>10 5<br>5 115<br>6 2 3 4 1 5</p></blockquote><h4 id="7隐藏关卡的分析与破解"><a class="anchor" href="#7隐藏关卡的分析与破解">#</a> 7. 隐藏关卡的分析与破解</h4><p>但是，还有一个问题</p><p><img data-src="image-20220411211625334.png" alt="image-20220411211625334"></p><p>之前查看函数时还有一个<strong> secret_phase</strong>, 但是在整个拆弹过程中也没有发现这个隐藏的炸弹，所以怀疑是有函数调用该隐藏关卡</p><p>继续查看该函数列表，发现与调用隐藏关卡相关的好像只有 <strong>phase_defused</strong></p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>disas phase_defused //查看函数汇编代码</pre></td></tr></table></figure><p><img data-src="image-20220411212000847.png" alt="image-20220411212000847"></p><p>函数刚开始做了判断，若接收 6 个字符串则向下跳转，否则函数返回。</p><p>据此可知只有完成所有的六个关卡才能够开启隐藏关</p><p>下面是对 sscanf 函数的调用</p><blockquote><p>int sscanf(const char *str, const char *format, ...)</p><ul><li><strong>str</strong> -- 这是 C 字符串，是函数检索数据的源。</li><li><strong>format</strong> -- 这是 C 字符串，包含了以下各项中的一个或多个：<em>空格字符、非空格字符</em> 和 <em>format 说明符</em>。</li></ul></blockquote><p>一共两个格式化参数。参数 str 为要读取数据的字符串，参数 format 是用户指定的格式</p><p>查看 0x403399 和 0x405870 处的内存</p><p><img data-src="image-20220411212810683.png" alt="image-20220411212810683"></p><p>由此可知需要输入的是 &quot;% d % d % s&quot; 类型的变量，并且是从 input_srings 处读取的</p><p><img data-src="image-20220411212928467.png" alt="image-20220411212928467"></p><p>之后，若成功读入三个参数，则直接跳转</p><p><img data-src="image-20220411213017987.png" alt="image-20220411213017987"></p><p>下面这里就和第一关基本一样，直接查看 0x4033a2 处的值</p><p><img data-src="image-20220411213055419.png" alt="image-20220411213055419"></p><p>就说明第三个参数是这个字符串，</p><p><img data-src="image-20220411213218943.png" alt="image-20220411213218943"></p><p><img data-src="image-20220411213225783.png" alt="image-20220411213225783"></p><p>继续往下看并且查看相应内存的数据之后就知道能够开启隐藏关卡了</p><p>但是还有一个问题是在哪一关输入这个神秘的字符串才能开启隐藏关呢</p><p>上面提到了 sscanf 函数的第一个参数是要读取的字符串的，但是当时查看该参数内存地址时并没有发现有用信息，推测是要在程序启动之后才能知道该内存具体的数值，所以下一步动态调试 phase_defused 函数来查看 sscanf 函数第一个参数的值以及推断在哪一关进入隐藏关卡。按照如下步骤操作，先在 Phase_4 处下断点，然后运行直到断点处，之后再在 phase_defused 函数处下断点，continue 进入 phase_defused 函数，如图</p><p><img data-src="image-20220411215256960.png" alt="image-20220411215256960"><img data-src="image-20220411215315483.png" alt="image-20220411215315483"></p><p>进入 Phase_defused 函数后发现有个关键跳转，就是验证输入字符串的数量是否等于 6，这里我们直接使用 set 命令 &quot;作弊&quot;。</p><p>刚开始是因为看到有 JE 跳转指令，所以我尝试更改 ZF 的值来更改程序运行方向，但是失败了，接着我看到了 cmp 后面是 num_input_strings 的地址，所以我查看了一下，发现数值为 4，也就是说一共输入了 4 次字符串，我尝试直接更改内存里的数据变成 6，但是失败了，所以我直接 set 后面跟变量名，成功了，这里就积累了经验，直接对内存地址进行修改可能会失败，更好的方法就是直接修改变量的值。</p><p><img data-src="image-20220411220747138.png" alt="image-20220411220747138"></p><p><img data-src="image-20220411220801465.png" alt="image-20220411220801465"></p><p><img data-src="image-20220411220834541.png" alt="image-20220411220834541"></p><p>修改完之后单步步过，直到之前的 sscanf 的第一个参数的内存地址，查看之后发现竟是第四关我们输入的密码，所以，就能推断出要在第四关输入密钥才能带我们进入隐藏关卡</p><p><img data-src="image-20220411220915578.png" alt="image-20220411220915578"></p><p>既然已经直到如何进入隐藏关卡，之后就可以破解隐藏关卡了</p><p><img data-src="image-20220411222159666.png" alt="image-20220411222159666"></p><p>直接查看汇编代码，核心函数为 fun7，并且查看 fun7 函数信息</p><p><img data-src="image-20220411225455838.png" alt="image-20220411225455838"></p><p>知道函数接受一个树节点 (rdi)，和一个整数 (rsi)</p><blockquote><p>C 库函数 <strong>int atoi(const char *str)</strong> 把参数 <strong>str</strong> 所指向的字符串转换为一个整数（类型为 int 型）。</p></blockquote><p>这个整数自然就是玩家输入的字符串转变而来，rdi 的初值就可以是树的根节点</p><p>尝试查看二叉树的结构</p><p><img data-src="image-20220411225706393.png" alt="image-20220411225706393"></p><p>很大的一棵树，但是不是很难分析</p><p>接着进入 fun7，发现很像之前一关的递归调用，有了上次的经验，我们就关注于每个条件分支</p><pre><code class="language-assembly">test eax,eax //这种汇编代码段的意义在于判断eax值是否为0或者是否为空
je [place]
</code></pre><p>于是就可以得出第一个分支</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>node<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>接着往下看</p><p><img data-src="image-20220411230043389.png" alt="image-20220411230043389"></p><p>这里首先是将根节点的 value 传给 eax，然后将 eax 与 fun7 的第二个参数比较</p><p>所以就可以根据下面的跳转条件得到其他分支</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">int</span> <span class="token function">fun7</span><span class="token punctuation">(</span>treenode<span class="token operator">*</span> node<span class="token punctuation">,</span><span class="token keyword">int</span> val<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span>    </pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>node<span class="token punctuation">)</span>	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token operator">-></span>value<span class="token operator">></span>val<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">fun7</span><span class="token punctuation">(</span>node<span class="token operator">-></span>left<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token operator">-></span>value<span class="token operator">==</span>val<span class="token punctuation">)</span>     <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">fun7</span><span class="token punctuation">(</span>node<span class="token operator">-></span>right<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>分析完 fun7 之后我们接着回到 secret_phase</p><p>就能继续编写出 secret_phase 的 C 语言代码</p><pre><code class="language-C">void __cdecl secret_phase()
&#123;
  char *line; // rax
  int v1; // ebx

  line = read_line();
  v1 = atoi(line);
  if ( (unsigned int)(v1 - 1) &gt; 0x3E8 )
    explode_bomb();
  if ( fun7(&amp;n1, v1) != 4 )
    explode_bomb();
  puts(&quot;Wow! You've defused the secret stage!&quot;);
  phase_defused();
&#125;
// FROM IDA PRO
</code></pre><p>至此，我们的分析工作全部完成</p><p><img data-src="image-20220411232244001.png" alt="image-20220411232244001"></p><p>最后根据第四关积累的经验，成功解出隐藏关卡密码 7</p><h4 id="end"><a class="anchor" href="#end">#</a> END</h4><p><img data-src="image-20220411232342795.png" alt="image-20220411232342795"></p><h3 id="三收获与心得"><a class="anchor" href="#三收获与心得">#</a> 三，收获与心得</h3><p>向 CMU 设计该实验的所有老师同学致敬，精密而又有趣的实验总是让人沉浸其中，</p><p>在一次次的解题中不断收获成就感，不断获得新知识，这种强烈的正反馈给了学生兴趣与好奇</p><p>salute ！</p><div class="tags"><a href="/tags/CSAPP-LAB/" rel="tag"><i class="ic i-tag"></i> CSAPP_LAB</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2022-04-28 20:42:50" itemprop="dateModified" datetime="2022-04-28T20:42:50+08:00">2022-04-28</time> </span><span id="2022/04/12/二进制炸弹/" class="item leancloud_visitors" data-flag-title="二进制炸弹" title="Views"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">Views</span> <span class="leancloud-visitors-count"></span> <span class="text">times</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="那我就让时光倒流 WeChat Pay"><p>WeChat Pay</p></div><div><img data-src="/images/alipay.png" alt="那我就让时光倒流 Alipay"><p>Alipay</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>那我就让时光倒流 <i class="ic i-at"><em>@</em></i>你越安静,你能听到的就越多</li><li class="link"><strong>Post link: </strong><a href="https://0x401000nu1l.github.io/2022/04/12/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%82%B8%E5%BC%B9/" title="二进制炸弹">https://0x401000nu1l.github.io/2022/04/12/二进制炸弹/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/2022/04/13/plan/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicivghyooj20zk0m8dir.jpg" title="plan"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i></span><h3>plan</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9Flab2"><span class="toc-number">1.</span> <span class="toc-text">哈尔滨工业大学计算机系统 LAB2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E5%AE%9E%E9%AA%8C%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-number">1.0.1.</span> <span class="toc-text">一，实验基本信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="toc-number">1.0.1.1.</span> <span class="toc-text">1. 实验目的</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E4%B8%8E%E5%B7%A5%E5%85%B7"><span class="toc-number">1.0.1.2.</span> <span class="toc-text">2. 实验环境与工具</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#21%E7%A1%AC%E4%BB%B6%E7%8E%AF%E5%A2%83"><span class="toc-number">1.0.1.2.1.</span> <span class="toc-text">2.1 硬件环境</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#22%E8%BD%AF%E4%BB%B6%E7%8E%AF%E5%A2%83"><span class="toc-number">1.0.1.2.2.</span> <span class="toc-text">2.2 软件环境</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#23-%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7"><span class="toc-number">1.0.1.2.3.</span> <span class="toc-text">2.3 开发工具</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%90%84%E9%98%B6%E6%AE%B5%E7%82%B8%E5%BC%B9%E7%9A%84%E7%A0%B4%E8%A7%A3%E4%B8%8E%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.</span> <span class="toc-text">二，各阶段炸弹的破解与分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%88%9D%E6%AD%A5%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">1. 初步分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E7%AC%AC%E4%B8%80%E5%85%B3%E7%9A%84%E7%A0%B4%E8%A7%A3%E4%B8%8E%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">2. 第一关的破解与分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E7%AC%AC%E4%BA%8C%E5%85%B3%E7%9A%84%E7%A0%B4%E8%A7%A3%E4%B8%8E%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.3.</span> <span class="toc-text">3. 第二关的破解与分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E7%AC%AC%E4%B8%89%E5%85%B3%E7%9A%84%E7%A0%B4%E8%A7%A3%E4%B8%8E%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.4.</span> <span class="toc-text">4. 第三关的破解与分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E7%AC%AC%E5%9B%9B%E5%85%B3%E7%9A%84%E7%A0%B4%E8%A7%A3%E4%B8%8E%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.5.</span> <span class="toc-text">5. 第四关的破解与分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E7%AC%AC%E4%BA%94%E5%85%B3%E7%9A%84%E7%A0%B4%E8%A7%A3%E4%B8%8E%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.6.</span> <span class="toc-text">6. 第五关的破解与分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E7%AC%AC%E5%85%AD%E5%85%B3%E7%9A%84%E7%A0%B4%E8%A7%A3%E4%B8%8E%E5%88%86%E6%9E%90"><span class="toc-number">1.0.2.7.</span> <span class="toc-text">7. 第六关的破解与分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E9%9A%90%E8%97%8F%E5%85%B3%E5%8D%A1%E7%9A%84%E5%88%86%E6%9E%90%E4%B8%8E%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.0.2.8.</span> <span class="toc-text">7. 隐藏关卡的分析与破解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#end"><span class="toc-number">1.0.2.9.</span> <span class="toc-text">END</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E6%94%B6%E8%8E%B7%E4%B8%8E%E5%BF%83%E5%BE%97"><span class="toc-number">1.0.3.</span> <span class="toc-text">三，收获与心得</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="Related"></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="那我就让时光倒流" data-src="/images/avatar.jpg"><p class="name" itemprop="name">那我就让时光倒流</p><div class="description" itemprop="description">(σﾟ∀ﾟ)σ..:*☆哎哟不错哦</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">10</span> <span class="name">posts</span></a></div><div class="item tags"><a href="/tags/"><span class="count">8</span> <span class="name">tags</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tLzB4NDAxMDAwTnUxbA==" title="https:&#x2F;&#x2F;github.com&#x2F;0x401000Nu1l"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnhpbmR1MTEwNkBnYW1pbC5jb20=" title="mailto:xindu1106@gamil.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/19/%E5%8F%B2%E4%B8%8A%E6%9C%80%E5%B0%8F%E7%9A%84elf%E6%96%87%E4%BB%B6/" title="史上最小的elf文件">史上最小的elf文件</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/18/%E6%B1%87%E7%BC%96-%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/" title="汇编语言中系统调用">汇编语言中系统调用</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/20/starCTF%E9%80%86%E5%90%91wp/" title="starCTF逆向wp">starCTF逆向wp</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/29/%E5%B7%A6%E8%BD%AC/" title="左转">左转</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/21/CTFshow%E5%8D%B7%E7%8E%8B%E6%9D%AFwp/" title="CTFshow卷王杯wp">CTFshow卷王杯wp</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/13/plan/" title="plan">plan</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/16/CTFshow36D%E6%9D%AFwp/" title="CTFshow36D杯wp">CTFshow36D杯wp</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/05/09/VNCTF2022%E9%80%86%E5%90%91%E9%83%A8%E5%88%86wp/" title="VNCTF2022逆向部分wp">VNCTF2022逆向部分wp</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/05/03/DASCTF%E5%9B%9B%E6%9C%88%E9%80%86%E5%90%91%E9%83%A8%E5%88%86wp/" title="DASCTF X FATE逆向部分wp">DASCTF X FATE逆向部分wp</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/12/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%82%B8%E5%BC%B9/" title="二进制炸弹">二进制炸弹</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">那我就让时光倒流 @ 那我就让时光倒流</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="Symbols count total">53k words</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="Reading time total">48 mins.</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/04/12/二进制炸弹/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>